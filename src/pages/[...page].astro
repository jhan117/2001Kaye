---
import type { GetStaticPaths } from "astro";
import { getCollection } from "astro:content";

import Layout from "@layouts/Layout.astro";
import { timeSince, formatDate } from "@utils/dateUtils";

export const getStaticPaths = (async ({ paginate }) => {
  const posts: Post[] = await getCollection("posts");
  return paginate(posts, { pageSize: 2 });
}) satisfies GetStaticPaths;

const { page } = Astro.props;
---

<Layout>
    <main>
      <div>
        <ul>
          {page.data.map((post) => (
            <li>
              <a href={`posts/${post.slug}`}>{post.data.title}</a>
              <p>{formatDate(post.data.pubDate)}</p>
              <p>{post.data.description}</p>
              <p>{timeSince(post.data.pubDate)}</p>
            </li>
          ))}
        </ul>
      </div>
      <div>
        <ul>
          <li>
            <a href={page.url.prev}>
              <i class="fa-solid fa-chevron-left"></i>
            </a>
          </li>
          <li>{page.currentPage}</li>
          <li>
            <a href={page.url.next}>
              <i class="fa-solid fa-chevron-right"></i>
            </a>
          </li>
        </ul>
      </div>
    </main>
  </Layout>
